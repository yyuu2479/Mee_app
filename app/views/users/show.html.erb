<div class="container">
  <div class="row">
    <!--ユーザー詳細情報-->
    <div class="col-md-3 mx-auto">
      <h3>ユーザー詳細ページ</h3>
      <div>
        <%= attachment_image_tag @user, :image, size: '150x150', format: 'jpeg', fallback: 'no_image.jpeg'%>
        <p><%= @user.nickname %></p>
        <p>
          <%= link_to 'フォロー一覧', user_following_path(@user), class: "btn btn-primary" %>
        </p>
        <p>
          <%= link_to 'フォロワー一覧', user_follower_path(@user), class: "btn btn-primary" %>
        </p>
        <p>
          <%= link_to '相互フォロー一覧', user_mutual_follow_path(@user), class: "btn btn-primary" %>
        </p>
        <% if current_user == @user %>
        <!--編集ボタン-->
          <p>
            <%= link_to '編集する', edit_user_path(@user), class: "btn btn-outline-success" %>
          </p>
        <% else %>
        <!--フォローボタン-->
          <% if current_user.following_user?(@user) %>
            <!--フォロー解除ボタン-->
            <%= link_to 'フォロー解除', user_relationship_path(@user), method: :delete, class: 'btn btn-info'%>
            <!--チャットルームボタン-->
            <% if @user.following_user?(current_user)%>
              <% if @is_room == true %>
                <!--既にチャットルームが存在していれば存在しているチャットルームへ-->
                <%= link_to 'チャットルームへ', room_path(@room_id) %>
              <% else %>
                <!--チャットルームを新規作成-->
                <%= form_with model: @room, local: true do |f| %>
                  <%= fields_for @entry do |e|%>
                    <%= e.hidden_field :user_id, value: @user.id %>
                  <% end %>
                  <%= f.submit 'チャットを始める'%>
                <% end %>
              <% end %>
            <% end %>
          <% else %>
            <!--フォロー作成ボタン-->
            <%= link_to 'フォローする', user_relationships_path(@user), method: :post, class: 'btn btn-outline-info'%>
          <% end %>
        <% end %>
      </div>
    </div>
    <!--いいね一覧-->
    <div class="col-md-9">
      <%= render 'likes/index', likes: @likes, user: @user%>
    </div>
  </div>
</div>
